<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin ‚Äî School</title>
<!-- admin-mobile-styles -->

<style>
  :root{
    --bg:#f8fafc; --card:#fff; --muted:#6b7280; --primary:#0ea5e9; --danger:#ef4444; --radius:12px;
  }
  /* page */
  body{ margin:0; padding:18px; font-family:Inter,system-ui,Segoe UI,Roboto,Arial; background:var(--bg); color:#0f172a; -webkit-font-smoothing:antialiased }
  header{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:14px }
  .brand{ font-weight:800; font-size:18px }
  /* swipeable tabs */
  .tabs{ display:flex; gap:8px; overflow-x:auto; -webkit-overflow-scrolling:touch; padding-bottom:6px; scrollbar-width:none; }
  .tabs::-webkit-scrollbar{ display:none; }
  .tab{ flex:0 0 auto; padding:8px 12px; border-radius:12px; background:#e6eef8; border:none; cursor:pointer; font-weight:800; white-space:nowrap }
  .tab.active{ background:var(--primary); color:#fff; box-shadow:0 8px 22px rgba(11,116,255,0.12) }

  main{ margin-top:8px }
  .page{ display:none; background:var(--card); padding:12px; border-radius:var(--radius); box-shadow:0 8px 28px rgba(2,6,23,0.04) }
  .page.active{ display:block }

  .page-header{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:12px }
  .page-header input, .page-header select { padding:8px 10px; border-radius:8px; border:1px solid #e6eef8; min-width:120px }
  .btn{ padding:8px 10px; border-radius:8px; border:none; cursor:pointer; font-weight:800 }
  .btn-primary{ background:var(--primary); color:#fff }
  .btn-ghost{ background:#f3f4f6 }

  /* compact mobile row */
  .list-row{ display:flex; align-items:center; justify-content:space-between; gap:10px; background:linear-gradient(180deg,#fff,#fbfdff);
    padding:10px; border-radius:10px; margin-bottom:10px; border:1px solid rgba(2,6,23,0.03); box-shadow:0 6px 18px rgba(2,6,23,0.03) }
  .row-left{ display:flex; gap:10px; align-items:center; min-width:0 }
  .no-badge{ min-width:36px; text-align:center; font-weight:900; color:var(--muted) }
  .id{ font-family:monospace; font-weight:800; min-width:86px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  .title{ font-weight:900; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:220px }
  .sub{ color:var(--muted); font-weight:700; font-size:0.92rem }
  .more-btn{ background:transparent; border:1px solid rgba(2,6,23,0.06); padding:8px 10px; border-radius:8px; cursor:pointer; font-weight:900 }

  /* desktop: keep table display (hide mobile rows) */
  @media(min-width:821px){
    .list-row{ display:none; }
    table.admin-table{ width:100%; border-collapse:collapse; }
    table.admin-table th, table.admin-table td { padding:10px; border-bottom:1px solid #eef2f9; text-align:left }
  }

  /* modal */
  #modalBackdrop{ position:fixed; inset:0; display:none; align-items:flex-end; justify-content:center; background:rgba(2,6,23,0.45); z-index:60; padding:12px; }
  #modal{ background:#fff; padding:14px; border-radius:12px; width:100%; max-width:920px; box-shadow:0 16px 48px rgba(2,6,23,0.35); position:relative }
  #modalTitle{ font-weight:800; margin-bottom:8px }
  #modalBody{ max-height:68vh; overflow:auto }
  #modalClose{ position:absolute; right:12px; top:12px; background:var(--danger); color:#fff; border-radius:8px; padding:6px; border:none; cursor:pointer }
  .modal-actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:12px; flex-wrap:wrap }
  .muted{ color:var(--muted) }
  .pill{ display:inline-block; padding:4px 8px; border-radius:999px; background:#f1f5f9; font-weight:800; color:var(--muted); font-size:.85rem }

  /* --------- Payments UI tweaks (mobile two-row header, colors, loader) --------- */

/* container row splitting for payments header */
.page-header {
  gap: 8px;
}
.page-header .ph-row { display:flex; gap:8px; align-items:center; width:100%; }
.page-header .ph-left { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.page-header .ph-right { display:flex; gap:8px; align-items:center; margin-left:auto; flex-wrap:wrap; }

/* small screens: stack into two lines */
@media (max-width:720px){
  .page-header { flex-direction:column; align-items:stretch; gap:6px; }
  .page-header .ph-row { justify-content:space-between; }
  /* make search consume single row */
  #paymentsSearch { flex:1; min-width: 0; }
  /* second row holds filters & export (wrap if needed) */
  #paymentsClassFilter, #paymentsStatusFilter, #paymentsTeacherSubjectFilter {
    min-width: 120px; max-width: 45%;
  }
  #paymentsExport { order: 99; margin-left:auto; }
}

/* colors for fee / balance / class */
.fee-blue { color:#246bff; font-weight:900; }
.balance-red { color:#ef4444; font-weight:900; }
.class-blue { color:#0b74ff; font-weight:900; }

/* 3-dot loader used inside buttons */
.btn-loader { display:inline-flex; gap:6px; align-items:center; padding-left:4px; padding-right:4px; }
.btn-loader span { width:6px; height:6px; border-radius:50%; background:rgba(255,255,255,0.95); display:inline-block; opacity:0.95; transform:translateY(0); animation: btn-dot 900ms infinite; }
.btn-loader span:nth-child(2){ animation-delay:120ms; background:rgba(255,255,255,0.9); }
.btn-loader span:nth-child(3){ animation-delay:240ms; background:rgba(255,255,255,0.85); }
@keyframes btn-dot { 0%{ transform:translateY(0); opacity:0.35 } 50%{ transform:translateY(-6px); opacity:1 } 100%{ transform:translateY(0); opacity:0.35 } }

/* small styling for "more" modal content (mobile) */
.modal-more-grid { display:grid; grid-template-columns:1fr; gap:8px; }
.modal-more-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }

/* small icon wrappers to keep inline SVGs tidy */
.icon-sm { width:18px; height:18px; display:inline-block; vertical-align:middle; }

/* export logo smaller in export render */
@media print {
  img[export-logo] { max-height: 36px; }
}
/* make sure ID block doesn't force a gap when absent; allow id button to shrink/break */
.payments-card .id-block { flex: 0 0 auto; min-width:0; }
.payments-card .payments-id-btn { min-width:0; word-break:break-all; text-align:left; }
.payments-card .id-block.hidden { display:none; }

/* charts: enforce stable height so Chart.js does not expand endlessly */
.card canvas {
  width: 100% !important;
  height: 220px !important;
  display: block;
}
.card.chart-card { min-height: 260px; }


/* Hide desktop-only headers on mobile */
@media (max-width: 768px) {

/* Outstanding desktop header */
#outstandingCard > div:first-child {
  display: none !important;
}

/* Leaderboard desktop header */
#leaderboardCard > div:first-child {
  display: none !important;
}

}

/* ===== Compact Top-10 / Outstanding tweaks (mobile) ===== */
@media (max-width: 768px) {

/* make sure container uses border-box sizing so widths behave */
.page, .mobile-top10-header, .list-row, .mobile-top10-header .h-row, .mobile-top10-header .h-actions {
  box-sizing: border-box;
}

/* Search: full width but not pushing actions off screen */
.mobile-top10-header .h-row { display:block; }
.mobile-top10-header .h-row input[type="search"] {
  width:100%;
  box-sizing:border-box;
}

/* Actions: two compact buttons side-by-side ‚Äî don't expand more than half each */
.mobile-top10-header .h-actions {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  justify-content:space-between;
  margin-top:8px;
}
.mobile-top10-header .h-actions .btn {
  flex: 0 0 calc(50% - 6px); /* two columns with small gap */
  min-width: 0;
  padding:8px 6px;
  font-size:0.86rem;
  border-radius:10px;
  text-align:center;
}

/* List rows: allow left content to shrink & right actions to stay compact */
.list-row { align-items:center; gap:10px; padding:10px; }
.list-row .row-left { display:flex; gap:10px; align-items:center; min-width:0; flex:1 1 auto; }
.list-row .no-badge { min-width:30px; font-weight:900; color:var(--muted); text-align:center; }

/* Title & id: truncate but allow more room by calculating space left (safe fallback) */
.list-row .title {
  max-width: calc(100% - 150px); /* leave room for amount + action buttons */
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  font-weight:900;
}
.list-row .sub.id {
  font-family: monospace; font-weight:700; color:var(--muted);
  max-width: 120px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  font-size:0.82rem;
}

/* Right side actions ‚Äî vertical stack of small circular icon buttons */
.list-row .row-actions { display:flex; flex-direction:column; gap:8px; align-items:center; flex:0 0 auto; margin-left:8px; }
.list-row .row-actions .btn,
.list-row .row-actions .record-pay,
.list-row .row-actions .view-trans,
.list-row .row-actions .view-marks {
  width:36px; height:36px; padding:0; min-width:36px;
  border-radius:999px; display:inline-flex; align-items:center; justify-content:center;
  box-shadow:none; border:1px solid rgba(2,6,23,0.06); background:#fff;
}
/* Primary action should keep primary color fill */
.list-row .row-actions .record-pay.btn-primary { background:var(--primary); color:#fff; border: none; }

/* Amount column: keep prominent but compact */
.list-row .amount {
  min-width:80px;
  text-align:right;
  font-weight:900;
  color:var(--danger);
  margin-left:8px;
}

/* Ensure leaderboard small "View" buttons are compact */
.btn.view-marks { padding:0 8px; min-width:40px; height:36px; border-radius:8px; }

/* SVG/icon sizing inside compact buttons */
.list-row .row-actions svg, .btn.view-marks svg {
  width:18px; height:18px;
}

/* reduce card shadows slightly to avoid heavy long look */
.list-row { box-shadow: 0 6px 12px rgba(2,6,23,0.03); }

/* small spacing fixes */
.mobile-top10-header { padding:10px 8px; }
.mobile-top10-header .h-title { font-size:1rem; }
.mobile-top10-header .h-actions .btn.btn-primary { display:inline-flex; align-items:center; justify-content:center; }

}

/* === enforce mobile/desktop header visibility and compact rows === */
/* Make desktop-only hidden on small screens and mobile-only hidden on desktop */
.desktop-only { display: block; }
.mobile-only { display: none; }

@media (max-width: 768px) {
  .desktop-only { display: none !important; }
  .mobile-only { display: block !important; }

  /* tighter title truncation and amount + action sizing */
  .list-row .title { max-width: calc(100% - 140px); /* space for amount + actions */ }
  .list-row .sub.id { max-width: 110px; }

  .list-row .amount {
    min-width:72px; text-align:right; font-weight:900; color:var(--danger); margin-left:8px;
  }

  .list-row .row-actions { display:flex; flex-direction:column; gap:8px; align-items:center; flex:0 0 auto; margin-left:8px; }
  .list-row .row-actions .btn {
    width:36px; height:36px; padding:0; min-width:36px; border-radius:999px; display:inline-flex;
    align-items:center; justify-content:center; box-shadow:none; border:1px solid rgba(2,6,23,0.06); background:#fff;
  }
  .list-row .row-actions .btn-primary { background:var(--primary); color:#fff; border: none; }

  /* ensure header actions sit side-by-side and don't push search offscreen */
  .mobile-top10-header .h-actions { display:flex; gap:8px; flex-wrap:wrap; justify-content:space-between; }
  .mobile-top10-header .h-actions .btn { flex:0 0 calc(50% - 6px); min-width:0; padding:8px 6px; }

  /* make search full-width */
  .mobile-top10-header .h-row input[type="search"] { width:100%; box-sizing:border-box; }

  /* minor spacing */
  .mobile-top10-header { padding:10px 8px; border-bottom:1px solid #eef2f9; }
  .list-row { box-shadow: 0 6px 12px rgba(2,6,23,0.03); }
}


/* ===== fix outstanding header + compact mobile rows ===== */
.mobile-only { display:none; }
.desktop-only { display:block; }
@media (max-width:768px) {
  .mobile-only { display:block !important; }
  .desktop-only { display:none !important; }

  /* header: search full width on its own row, actions under it */
  .mobile-top10-header { padding:10px 8px; box-sizing:border-box; border-bottom:1px solid #eef2f9; }
  .mobile-top10-header .h-row { width:100%; margin-top:6px; }
  .mobile-top10-header .h-row input[type="search"] { width:100%; box-sizing:border-box; padding:10px; border-radius:10px; border:1px solid #e5e7eb; }
  .mobile-top10-header .h-actions { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; justify-content:space-between; }
  .mobile-top10-header .h-actions .btn { flex:0 0 calc(50% - 6px); min-width:0; padding:8px 6px; border-radius:10px; text-align:center; }

  /* list row: three logical regions */
  .list-row { display:flex; gap:12px; align-items:center; padding:10px; border-radius:10px;
    background:linear-gradient(180deg,#fff,#fbfdff); border:1px solid rgba(2,6,23,0.03); box-shadow:0 6px 12px rgba(2,6,23,0.03); box-sizing:border-box; }
  .list-row .row-left { display:flex; gap:10px; align-items:center; min-width:0; flex:1 1 auto; }
  .list-row .no-badge { min-width:30px; text-align:center; font-weight:900; color:var(--muted); }
  .list-row .title { font-weight:900; font-size:0.96rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:100%; }
  .list-row .sub { color:var(--muted); font-size:0.78rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:120px; }

  /* amount column keeps fixed width to avoid pushing name */
  .list-row .amount { flex:0 0 84px; text-align:right; font-weight:900; color:var(--danger); }

  /* action column ‚Äî vertical compact circular buttons */
  .list-row .row-actions { flex:0 0 44px; display:flex; flex-direction:column; gap:8px; align-items:center; margin-left:4px; }
  .list-row .row-actions .btn { width:36px; height:36px; padding:0; min-width:36px; border-radius:999px; display:inline-flex; align-items:center; justify-content:center; border:1px solid rgba(2,6,23,0.06); background:#fff; box-shadow:none; }
  .list-row .row-actions .btn.btn-primary { background:var(--primary); color:#fff; border:none; }

  /* ensure leaderboard view button is compact on mobile if used */
  .btn.view-marks { padding:0 8px; min-width:40px; height:36px; border-radius:8px; }

  /* small tweaks */
  .mobile-top10-header .h-title { font-weight:900; font-size:1rem; }
  .mobile-top10-header .h-sub { font-size:0.82rem; color:#6b7280; }

  /* always allow header export/button area to wrap instead of overflowing */
  .mobile-top10-header .h-actions { overflow:visible; }
}


/* Admin attendance styles (paste into your admin styles) */
.attendance-page-header{ display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:12px }
.attendance-page-header select, .attendance-page-header input[type="date"]{ padding:8px 10px;border-radius:8px;border:1px solid #e6eef8 }
.attendance-controls { margin-left:auto; display:flex; gap:8px; align-items:center; position:relative; }

.attendance-cards { display:grid; grid-template-columns:1fr; gap:10px; margin-top:12px }
.attendance-card{ padding:12px; border-radius:10px; background:#fff; border:1px solid #eef2f7; display:flex; justify-content:space-between; align-items:center; cursor:pointer }
.attendance-card .meta{ color:#6b7280; font-weight:700; }
.attendance-card .subjects{ font-size:0.88rem; color:#0f1724; margin-top:6px; }

/* Single page class view (header + editor) */
.att-class-header{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; padding:8px 0 }
.att-editor{ margin-top:10px; background:#fff; border-radius:10px; padding:10px; border:1px solid #eef2f7; min-height:220px }

/* row styles */


.att-row{ display:flex; gap:12px; padding:10px; border-bottom:1px solid #f4f6f9; align-items:center }
.att-row .name{ flex:1; font-weight:800 }
.att-row .row-pct{ color:#6b7280; font-weight:800 }

/* admin checkboxes */
.admin-att-chk{ margin-right:6px }

/* export dropdown */
.export-menu{ position:absolute; right:0; top:38px; background:#fff; border:1px solid #eef2f7; padding:8px; border-radius:8px; box-shadow:0 8px 30px rgba(2,6,23,0.06); z-index:120; display:none }
.export-menu button{ display:block; width:100%; text-align:left; padding:8px 10px; border-radius:6px; background:transparent; border:none; cursor:pointer }

/* small helpers */
.hidden{ display:none }
.muted{ color:#6b7280 }

/* responsive: two-column cards on wide screens */
@media(min-width:900px){ .attendance-cards{ grid-template-columns:1fr 1fr } }


#attendanceClassView {
  position: relative;
  z-index: 20;
}

#attendanceList.hidden {
  display: none !important;
}

.more-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}

.more-grid .full{
  grid-column: 1 / -1;
  display:flex;
  justify-content:center;
}

.btn-open{ background:#2563eb; color:#fff; }
.btn-subj{ background:#059669; color:#fff; }
.btn-att{ background:#f59e0b; color:#111; }
.btn-hist{ background:#7c3aed; color:#fff; }
.btn-export{ background:#111827; color:#fff; }

.btn svg{
  margin-right:6px;
}

.export-menu{
  min-width:140px;
}

.export-menu button{
  width:100%;
  display:flex;
  align-items:center;
  gap:8px;
}


/* ==== EXPORT DROPDOWN FIX ==== */

.export-dropdown{
  position: relative;
  overflow: visible !important;
}

.export-menu{
  position: absolute;
  top: 110%;
  right: 0;
  z-index: 99999 !important;
  background: #ffffff;
  border-radius: 10px;
  padding: 6px;
  min-width: 160px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.18);
  border: 1px solid #e5e7eb;
}

/* .export-menu.hidden{
  display: none !important;
} */

.export-menu button{
  width: 100%;
  padding: 10px 12px;
  border-radius: 8px;
  background: #f9fafb;
  border: none;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}

.export-menu button:hover{
  background: #eef2ff;
}


.modal-body,
.modal-content{
  overflow: visible !important;
}


/* ===== MOBILE ONLY: attendance student preview ===== */
@media (max-width: 768px) {

.att-row{
  flex-direction: column;
  align-items: stretch;
  gap: 6px;
}

.att-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
}

.att-row > div:first-child{
  display:none; /* hide number column on mobile */
}

.att-row .name{
  font-weight: 900;
  font-size: 0.95rem;
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* student id under name */
.att-row .student-id-mobile{
  font-family: monospace;
  font-size: 0.78rem;
  color: #6b7280;
  font-weight: 700;
  max-width: 120px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* percentage on the right */
.att-row .row-pct{
  align-self: flex-end;
  font-weight: 900;
  font-size: 0.85rem;
  color: #0f172a;
}
}


.export-dropdown{
  position: relative;
  overflow: visible !important;
}

.export-menu{
  position: absolute;
  top: 110%;
  right: 0;
  z-index: 99999;
  background: #fff;
  border-radius: 10px;
  padding: 6px;
  min-width: 160px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.18);
  border: 1px solid #e5e7eb;
  display: block;
}

.export-menu.hidden{
  display: none !important;
}

.export-menu button{
  width:100%;
  padding:10px 12px;
  border-radius:8px;
  border:none;
  background:#f9fafb;
  font-weight:800;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:8px;
}

.export-menu button:hover{
  background:#eef2ff;
}




/* Announcements specific */
.ann-controls .header-new { display:inline-flex; align-items:center; gap:6px; }
.ann-controls .header-new .icon-new { display:inline-block; }
.ann-controls .header-refresh { display:inline-flex; align-items:center; justify-content:center; padding:8px; border-radius:8px; }
.ann-controls .header-settings { display:inline-flex; align-items:center; justify-content:center; padding:8px; border-radius:8px; }

.icon-new { stroke: #0ea5e9; }         /* blue-ish for New (keeps contrast with white text) */
.header-new { background: #06b6d4; color: #fff; border-color: #06b6d4; }
.header-new:hover { filter:brightness(.95); transform:translateY(-1px); transition:all .12s ease; }

.icon-refresh { stroke: #374151; }      /* neutral dark for refresh */
.icon-gear, .icon-gear path { stroke: #374151; }

.ann-row .btn-edit svg { stroke:#0f1724; }
.ann-row .btn-delete svg { stroke:#ef4444; }

/* cards list responsiveness */
#announcementsList { display:flex; flex-direction:column; gap:10px; }
#announcementsList .card { transition: transform .12s ease, box-shadow .12s ease; border-radius:10px; }
#announcementsList .card:hover { transform: translateY(-4px); box-shadow:0 10px 24px rgba(2,6,23,0.06); }

/* modal body top10 responsive */
.modal .top10-row { display:flex; justify-content:space-between; gap:12px; padding:8px; border-bottom:1px solid #f3f4f6; }
.modal .top10-row .left { min-width:0; }
.modal .top10-row .right { min-width:80px; text-align:right; }

/* mobile adjustments */
@media (max-width:720px){
  .ann-controls { flex-wrap:wrap; gap:6px; }
  .ann-controls .header-new span { display:none; } /* compact on small screens */
  #announcementsList .card { padding:10px; }
  .modal .top10-row { flex-direction:column; align-items:flex-start; gap:6px; }
  .modal .top10-row .right { text-align:left; }
}

@media (max-width:720px){
  .ann-controls .header-new span { display:none; } /* compact on small screens */
}
/* Users UI - responsive (improved header layout) */
.users-top {
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:12px;
  flex-wrap:nowrap;         /* keep items on one row if possible */
  overflow:hidden;          /* prevent ugly wrapping to multiple rows */
}

/* Controls inside header */
.users-top #addUserBtn {
  flex: 0 0 auto;
  white-space:nowrap;
  padding:8px 12px;
}
.users-top .total {
  flex: 0 0 auto;
  font-weight:600;
  background:linear-gradient(90deg,#eef2ff,#fff);
  padding:6px 10px;
  border-radius:10px;
  font-size:14px;
  min-width:60px;
  text-align:center;
}

/* search grows to use remaining space but won't force wrap */
.users-top .users-search {
  flex: 1 1 220px;   /* grow/shrink, prefer 220px */
  min-width:120px;
  max-width:100%;
  padding:8px;
  border-radius:8px;
  border:1px solid #e6eef8;
  box-sizing:border-box;
}

/* fallback: if the screen is very narrow, allow it to wrap cleanly */
@media (max-width:360px) {
  .users-top { flex-wrap:wrap; gap:8px; }
  .users-top .users-search { flex-basis:100%; }
  .users-top .total { order:2; }
}

/* rest of your styles (kept as before) */
.users-table {
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
.users-table thead th {
  text-align:left;
  padding:10px;
  color:#475569;
  font-weight:600;
  border-bottom:1px solid #e6eef8;
}
.users-table tbody td {
  padding:10px;
  border-bottom:1px solid rgba(15,23,42,0.04);
  vertical-align:middle;
}
.action-btn {
  display:inline-flex;
  gap:8px;
  align-items:center;
  border:0;
  background:transparent;
  cursor:pointer;
  padding:6px;
  border-radius:8px;
}
.action-btn[disabled] {
  opacity:.45;
  cursor:not-allowed;
}
.btn-icon {
  display:inline-grid;
  place-items:center;
  width:36px;
  height:36px;
  border-radius:8px;
  background:transparent;
  border:1px solid rgba(15,23,42,0.02);
}
.card-list {
  display:grid;
  gap:10px;
}
.user-card {
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(15,23,42,0.04);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.user-card .left { display:flex;align-items:center;gap:10px; }
.user-card .meta { font-size:13px; color:#334155; }
.user-card .role-pill {
  padding:6px 8px;
  border-radius:999px;
  font-size:12px;
  background:#f1f5f9;
  color:#0f1724;
}

/* mobile-only: show cards, hide table */
@media (max-width:780px) {
  .users-table { display:none; }
  .card-list { display:block; }
}
/* desktop-only: show table, hide cards */
@media (min-width:781px) {
  .card-list { display:none; }
}


@media (max-width:780px){
  /* hide desktop action buttons on mobile in case they appear */
  .users-table .action-btn, .user-card .action-btn { display:none !important; }
  /* ensure mobile btn-icon View is visible */
  .user-card .btn-icon { display:inline-grid; }
}
@media (min-width:781px){
  /* hide mobile-only view icon in desktop cards */
  .user-card .btn-icon.btn-view { display:none; }
}

/* Recycle Bin styles */
#recycleTable .muted { color:#6b7280; }
.recycle-type-pill { padding:6px 8px; border-radius:999px; background:#f1f5f9; font-weight:700; font-size:12px; }
.recycled-meta { color:#6b7280; font-size:13px; }
.recycle-actions .btn { margin-left:6px; }
@media (max-width:780px) {
  #recycleTableContainer { display:none; }
  #recycleCardList { display:block; }
}
@media (min-width:781px) {
  #recycleCardList { display:none; }
}

/* add/replace into tt-modal-styles */
.tt-icon-btn { background:transparent;border:0;padding:4px;cursor:pointer;border-radius:6px;display:inline-flex;align-items:center;justify-content:center }
.tt-icon-btn svg{ width:14px;height:14px;vertical-align:middle }
.btn.btn-ghost.btn-sm, .btn.btn-primary.btn-sm { padding:4px 8px;font-size:12px }
.tt-table th, .tt-table td { padding:6px; font-size:13px } /* slightly smaller cells */
.tt-period-id { font-weight:700; margin-right:4px; font-size:13px }


/* ================= TOAST (GLOBAL) ================= */
#toast{
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 99999; /* ABOVE modals, sidebars, overlays */
  min-width: 260px;
  max-width: 360px;
  padding: 14px 18px;
  border-radius: 12px;
  font-size: 14px;
  font-weight: 500;
  color: #fff;
  background: linear-gradient(135deg, #0b74ff, #095ad6);
  box-shadow: 0 12px 30px rgba(0,0,0,.25);
  display: none;
  opacity: 0;
  transform: translateY(-12px) scale(.98);
  transition: opacity .25s ease, transform .25s ease;
  pointer-events: none;
}

/* visible state */
#toast.show{
  display: block;
  opacity: 1;
  transform: translateY(0) scale(1);
}

/* ---- variants ---- */
#toast.success{
  background: linear-gradient(135deg, #16a34a, #15803d);
}

#toast.error{
  background: linear-gradient(135deg, #dc2626, #b91c1c);
}

#toast.warning{
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: #111;
}

#toast.info{
  background: linear-gradient(135deg, #0b74ff, #095ad6);
}

/* ================= TOAST SYSTEM ================= */
#toast-container{
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 99999;
  display: flex;
  flex-direction: column;
  gap: 12px;
  pointer-events: none;
}

/* toast item */
.toast{
  min-width: 280px;
  max-width: 380px;
  background: var(--toast-bg);
  color: var(--toast-text);
  border-radius: 14px;
  padding: 14px 38px 16px 16px;
  box-shadow: 0 14px 35px rgba(0,0,0,.25);
  display: flex;
  gap: 12px;
  align-items: flex-start;
  animation: toast-in .35s ease;
  position: relative;
  overflow: hidden;
  pointer-events: auto;
}

/* icon */
.toast .icon{
  font-size: 18px;
  margin-top: 2px;
}

/* message */
.toast .msg{
  font-size: 14px;
  font-weight: 500;
  line-height: 1.45;
}

/* close */
.toast .close{
  position: absolute;
  top: 8px;
  right: 10px;
  cursor: pointer;
  font-size: 14px;
  opacity: .7;
}
.toast .close:hover{ opacity:1 }

/* progress bar */
.toast .bar{
  position: absolute;
  left: 0;
  bottom: 0;
  height: 4px;
  width: 100%;
  background: rgba(255,255,255,.45);
  transform-origin: left;
}

/* animation */
@keyframes toast-in{
  from{ opacity:0; transform:translateY(-10px) scale(.97); }
  to{ opacity:1; transform:none; }
}

/* variants (accent synced) */
.toast.success{ --toast-bg: linear-gradient(135deg,#16a34a,#15803d); --toast-text:#fff; }
.toast.error{ --toast-bg: linear-gradient(135deg,#dc2626,#b91c1c); --toast-text:#fff; }
.toast.warning{ --toast-bg: linear-gradient(135deg,#f59e0b,#d97706); --toast-text:#111; }
.toast.info{ --toast-bg: linear-gradient(135deg,var(--accent,#0b74ff),#095ad6); --toast-text:#fff; }

/* ---------- mobile slide ---------- */
@media (max-width:640px){
  #toast-container{
    top:auto;
    bottom:20px;
    right:50%;
    transform:translateX(50%);
  }
  .toast{
    animation: toast-mobile .35s ease;
  }
  @keyframes toast-mobile{
    from{ opacity:0; transform:translateY(14px); }
    to{ opacity:1; transform:none; }
  }
}

/* ---------- history ---------- */
#toast-history-btn{
  position: fixed;
  bottom: 18px;
  right: 18px;
  z-index: 99998;
  border:none;
  border-radius:50%;
  width:44px;
  height:44px;
  background: var(--accent,#0b74ff);
  color:#fff;
  font-size:18px;
  cursor:pointer;
}

#toast-history{
  position: fixed;
  bottom: 70px;
  right: 18px;
  width: 320px;
  max-height: 380px;
  background:#fff;
  border-radius:14px;
  box-shadow:0 20px 40px rgba(0,0,0,.25);
  overflow:auto;
  display:none;
  z-index:99999;
}

#toast-history .item{
  padding:12px 14px;
  border-bottom:1px solid #eee;
  font-size:13px;
}





/* ================= MODAL SYSTEM ================= */
#modalBackdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.55);
  display: none;
  align-items: center;     /* CENTER vertically */
  justify-content: center; /* CENTER horizontally */
  z-index: 90000;          /* below toast, above app */
  padding: 16px;
}

#modal{
  background: #fff;
  border-radius: 16px;
  width: 100%;
  max-width: 720px;
  max-height: 90vh;
  padding: 22px 22px 20px;
  box-shadow: 0 30px 80px rgba(0,0,0,.35);
  position: relative;

  /* scrolling */
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;

  /* animation */
  opacity: 0;
  transform: scale(.96) translateY(10px);
  transition: opacity .25s ease, transform .25s ease;
}

/* Chrome / Edge */
#modal::-webkit-scrollbar{
  width: 8px;
}
#modal::-webkit-scrollbar-thumb{
  background: rgba(0,0,0,.25);
  border-radius: 8px;
}
#modal:not(:hover)::-webkit-scrollbar-thumb{
  background: transparent;
}


/* visible state */
#modalBackdrop.show #modal{
  opacity: 1;
  transform: scale(1) translateY(0);
}

/* title */
#modalTitle{
  margin: 0 32px 14px 0;
  font-size: 18px;
  font-weight: 700;
}

/* close button ‚Äî ALWAYS visible */
#modalClose{
  position: absolute;
  top: 14px;
  right: 14px;
  z-index: 10;               /* ‚Üê FIX */
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  background: rgba(249, 4, 4, 0.947);
  font-size: 18px;
  cursor: pointer;
  display: flex;
  
  align-items: center;
  justify-content: center;
  opacity: .75;
}

#modalClose:hover{
  opacity: 1;
  background: rgba(0,0,0,.12);
}

#modalClose:hover{ opacity:1 }


@media (max-width:640px){
  #modalBackdrop{
    align-items: flex-end;
  }

  #modal{
    max-width: 100%;
    max-height: 92vh;
    border-radius: 20px 20px 0 0;
    transform: translateY(20px);
  }

  #modalBackdrop.show #modal{
    transform: translateY(0);
  }
}

/* fullscreen modal */
#modal.fullscreen{
  max-width: 100%;
  max-height: 100%;
  width: 100%;
  height: 100%;
  border-radius: 0;
}

</style>
</head>
<body>
  <header>
    <div class="brand">Admin ‚Äî School System</div>
    <div>
      <button id="btnLogout" class="btn btn-ghost">Logout</button>
    </div>
  </header>

  <nav class="tabs" role="navigation" aria-label="Admin pages">
    <button id="tabDashboard" class="tab active">Dashboard</button>

    <button id="tabStudents" class="tab ">Students</button>
    <button id="tabPayments" class="tab">Payments</button>

    <button id="tabClasses" class="tab">Classes</button>
    <button id="tabSubjects" class="tab">Subjects</button>
    <button id="tabExams" class="tab">Exams</button>
    <button id="tabTeachers" class="tab">Teachers</button>
    <!-- somewhere in header or nav buttons -->

      <!-- NEW: Announcements -->
    <button id="tabAnnouncements" class="tab">Announcements</button>


    <button id="tabAttendance" class="tab">Attendance</button>
    <button id="gotoLeaderboardBtn" class="btn">Competition</button>
    <button id="tabRecycle" class="tab">Recycle Bin</button>
    <button id="tabUsers" class="tab">Users</button>


  </nav>

  <!-- PAGES -->
  <main>
    <section id="pageStudents" class="page" style="display:none">
      <div class="page-header">
        <input id="studentsSearch" type="text" placeholder="Search students..." />
        <select id="studentsClassFilter"></select>
        <button id="openAddStudent" class="btn btn-primary">+ Add Student</button>
      </div>
      <div id="studentsList"></div>
    </section>

    <section id="pageClasses" class="page" style="padding:12px">
      <style>
        /* hide the desktop-only header on small screens to avoid duplicate search/total */
        @media (max-width: 900px) {
          .desktop-only-header { display: none !important; }
        }
        /* hide mobile-only header on large screens (mobile UI is created by renderClasses()) */
        @media (min-width: 901px) {
          .mobile-only-header { display: none !important; }
        }
      </style>
    
      <!-- Desktop single header (search + add + move all on one line) -->
      <div class="page-header desktop-only-header" style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:nowrap;">
        <div style="display:flex;align-items:center;gap:8px;min-width:320px;flex:1">
          <input id="classSearch" type="search" placeholder="Search class name or students..." style="flex:1;min-width:180px;padding:8px;border:1px solid #e6eef8;border-radius:6px" />
          <button id="openAddClassDesktop" class="btn btn-primary" style="white-space:nowrap">+ Add class</button>
          <button id="openMoveAllDesktop" class="btn btn-ghost">Move all</button>
        </div>
    
        <!-- total count on the right for desktop -->
        <div style="min-width:200px;text-align:right;font-weight:700">
        </div>
      </div>
    
      <!-- container populated by renderClasses() -->
      <div id="classesList"></div>
    </section>

    <section id="pageSubjects" class="page">
      <div class="page-header">
        <input id="subjectSearch" type="text" placeholder="Search subjects..." />
        <button id="openAddSubject" class="btn btn-primary">+ Add Subject</button>
      </div>
      <div id="subjectsList"></div>
    </section>

    <section id="pageExams" class="page">
      <div class="page-header">
        <input id="examSearch" type="text" placeholder="Search exams..." />
        <select id="examClassFilter"></select>
        <button id="openAddExam" class="btn btn-primary">+ Add Exam</button>
      </div>
      <div id="examsList"></div>
    </section>

    <section id="pageTeachers" class="page">
      <div class="page-header">
        <input id="teachersSearch" type="text" placeholder="Search teachers..." />
        <select id="teachersSubjectFilter"></select>
        <button id="openAddTeacher" class="btn btn-primary">+ Add Teacher</button>
      </div>
      <div id="teachersList"></div>
    </section>


    <!-- Dashboard page (renderDashboard should populate this) -->
<section id="pageDashboard" class="page" style="display:block; padding:12px;">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
    <h2 style="margin:0">Dashboard</h2>
    <div id="dashboardHeaderActions" style="display:flex;gap:8px"></div>
  </div>

  <!-- Quick stat cards / chart containers (your renderDashboard can fill these) -->
  <div id="dashboardCards" style="display:flex;gap:12px;flex-wrap:wrap"></div>
  <div id="dashboardCharts" style="margin-top:12px"></div>
</section>

<!-- Payments page placeholder (renderPayments populates / may create page if not present) -->
<section id="pagePayments" class="page" style="display:none; padding:12px;">
  <div id="paymentsContainer">Loading payments...</div>
</section>

<!-- Attendance page placeholder (renderAttendance should populate this) -->
<section id="pageAttendance" class="page" style="display:none; padding:12px;">
  <div id="attendanceContainer">Attendance page placeholder</div>
</section>

<!-- Users page placeholder (renderUsers should populate this) -->
<section id="pageUsers" class="page" style="display:none; padding:12px;">
  <div id="usersContainer">Users page placeholder</div>
</section>
    <section id="pageAnnouncements" class="page" style="display:none; padding:12px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <h2 style="margin:0">Announcements</h2>
        <div id="ann-header-placeholder" style="display:flex;gap:8px;align-items:center">
          <!-- JS will render the New / Refresh / Settings controls here -->
        </div>
      </div>
    
      <div id="announcementsList" style="display:flex;flex-direction:column;gap:10px;">
        Loading announcements...
      </div>
    </section>
    
    <!-- Recycle Bin page -->
<section id="pageRecycle" class="page" style="display:none; padding:12px;">
  <div class="page-header" style="align-items:flex-start; gap:8px; flex-wrap:wrap;">
    <div style="display:flex;gap:8px;align-items:center">
      <select id="recycleTypeFilter">
        <option value="all">All types</option>
        <option value="students">Students</option>
        <option value="teachers">Teachers</option>
        <option value="classes">Classes</option>
        <option value="subjects">Subjects</option>
        <option value="exams">Exams</option>
        <option value="transactions">Transactions</option>
        <option value="users">Users</option>
        <option value="announcements">Announcements</option>
      </select>
      <input id="recycleSearch" placeholder="Search (name, email, id)"/>
    </div>

    <div style="display:flex;gap:8px;align-items:center;margin-left:auto">
      <label style="font-size:13px;color:#6b7280">Deleted from</label>
      <input id="recycleDateFrom" type="date" />
      <label style="font-size:13px;color:#6b7280">to</label>
      <input id="recycleDateTo" type="date" />
      <button id="recycleApplyFilters" class="btn btn-ghost">Apply</button>
      <button id="recycleRestoreAll" class="btn btn-primary">Restore All</button>
      <button id="recycleDeleteAll" class="btn btn-danger">Delete All</button>
    </div>
  </div>

  <div id="recycleCounts" style="margin:8px 0;color:#374151;font-weight:700"></div>

  <!-- table view (desktop) -->
  <div id="recycleTableContainer" style="overflow:auto">
    <table class="users-table" id="recycleTable" style="width:100%">
      <thead>
        <tr><th style="width:48px">No</th><th>Type</th><th>Title / Name</th><th>Details</th><th style="width:180px">Deleted</th><th style="width:180px">Actions</th></tr>
      </thead>
      <tbody id="recycleTbody"></tbody>
    </table>
  </div>

  <!-- cards for mobile -->
  <div id="recycleCardList" class="card-list" style="margin-top:12px"></div>
</section>


  </main>

  <!-- Modal (shared) -->
  <div id="modalBackdrop">
    <div id="modal">
      <button id="modalClose">‚úï</button>
      <h3 id="modalTitle"></h3>
      <div id="modalBody"></div>
    </div>
  </div>

  <div id="toast-container"></div>

  <button id="toast-history-btn" title="Notifications">üîî</button>
  <div id="toast-history"></div>
  
  <!-- Add these BEFORE database.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<!-- Chart.js (for charts) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<!-- Ensure html2canvas, jspdf, etc. are loaded already (you already included them). -->
<!-- Then load firebase-config.js and database.js (your existing scripts). -->

<!-- <script>
  // If renderDashboard is exported globally in database.js, call it on page load.
  // Wait a tick to let your module load caches; adjust if your init flow differs.
  window.addEventListener('load', () => {
    try {
      // show dashboard page and call renderDashboard
      if (typeof renderDashboard === 'function') {
        renderDashboard({ defaultFilter: 'This Month' }).catch(err => console.error('renderDashboard failed', err));
      } else {
        // if module exports differently, try a short delay
        setTimeout(() => {
          if (typeof renderDashboard === 'function') renderDashboard({ defaultFilter: 'This Month' });
        }, 400);
      }
    } catch (e) { console.error(e); }
  });
</script> -->

  <!-- Firebase config + app logic -->
  <!-- Make sure database.js path is correct and it's type=module -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="database.js"></script>
</body>
</html>
