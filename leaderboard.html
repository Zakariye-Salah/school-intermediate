<!doctype html>
<html lang="so">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Leaderboard — AL-FATXI</title>
  <link rel="stylesheet" href="style.css">
<style>
  :root{
  --bg:#fbfdff;
  --text:#0f172a;
  --muted:#6b7280;
  --card-bg:#fff;
  --card-shadow:0 8px 30px rgba(15,23,42,0.04);
  --primary:#0b74ff;
  --radius:12px;
  --gap:8px;

  /* compact scale values (adjust if you want even smaller) */
  --fs-base:14px;
  --fs-small:12px;
  --fs-tiny:11px;
  --pad-td:8px;
  --pad-td-mobile:6px;
}

/* base page */
html,body{height:100%;margin:0}
body{
  font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  background:var(--bg);
  color:var(--text);
  font-size:var(--fs-base);
  line-height:1.25;
}

/* container */
.container{ max-width:980px; margin:14px auto; padding:12px; box-sizing:border-box; }

/* cards */
.card{ background:var(--card-bg); border-radius:var(--radius); padding:12px; box-shadow:var(--card-shadow); margin-bottom:12px; }

/* header */
header{ display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
header h1{ margin:0; font-size:1.05rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* tiny helper */
.small-muted{ color:var(--muted); font-size:var(--fs-small); }

/* compact buttons */
.btn{ display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:8px; cursor:pointer; font-weight:700; font-size:0.95rem; border:1px solid rgba(11,116,255,0.06); background:#fff; }
.btn-primary{ background:var(--primary); color:#fff; border-color:var(--primary); }
.btn-ghost{ background:#fff; color:var(--text); border-color:#e6eefc; }

/* table wrapper (enable scroll on narrow screens) */
.table-wrap { width:100%; overflow-x:auto; -webkit-overflow-scrolling:touch; border-radius:10px; padding:6px; background:linear-gradient(180deg,#fff,#fbfdff); box-sizing:border-box; }

/* stable table layout for compactness */
table.leader{
  width:100%;
  border-collapse:collapse;
  table-layout: fixed; /* keeps columns compact & predictable */
  min-width:640px;     /* allow scroller if needed on very small screens */
  font-family:inherit;
}

/* columns via colgroup classes (you included them already) */
.col-rank  { width:64px; }
.col-name  { width:auto; }
.col-class { width:56px; }
.col-id    { width:68px; }
.col-points{ width:68px; }
.col-action{ width:96px; }

/* header cells */
table.leader thead th{
  font-weight:800;
  color:var(--muted);
  font-size:13px;
  padding:10px 8px;
  text-align:left;
  vertical-align:middle;
  border-bottom:1px solid rgba(241,245,249,0.9);
  white-space:nowrap;
}

/* body cells */
table.leader td{
  padding:var(--pad-td) 8px;
  font-weight:800;
  font-size:14px;
  text-align:left;
  vertical-align:middle;
  border-bottom:1px solid rgba(245,248,251,0.9);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* rank badge */
.rank-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:44px;
  height:44px;
  border-radius:10px;
  font-weight:900;
  box-shadow:0 6px 18px rgba(2,6,23,0.06);
  background:#fff9e6;
  color:#07122b;
  font-size:1rem;
}

/* small rank sizes for tiny screens */
.rank-badge.small { min-width:36px; height:36px; font-size:0.92rem; }

/* points badge */
.points-badge{ display:inline-block; padding:6px 10px; border-radius:8px; font-weight:800; min-width:56px; text-align:center; font-size:0.95rem; background:linear-gradient(180deg,#f3f9ff,#eef6ff); }

/* ID mask monospace */
.id-mask{ font-family:monospace; letter-spacing:0.6px; font-size:0.95rem; color:var(--muted); }

/* actions */
.actions-wrap{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.actions-wrap .btn, .btn { padding:6px 8px; font-size:0.88rem; }

/* clickable truncated name/class */
.student-toggle, .class-toggle{
  cursor:pointer;
  color:inherit;
  text-decoration:none;
  display:inline-block;
  max-width:100%;
  overflow:hidden;
  white-space:nowrap;
  text-overflow:ellipsis;
  vertical-align:middle;
  transition:all .18s ease;
  font-weight:800;
  font-size:0.95rem;
}

/* when toggled, allow wrapping and show full text (only for that element) */
.student-toggle.expanded, .class-toggle.expanded{
  white-space:normal;
  display:block;
  font-weight:900;
  font-size:1rem;
  line-height:1.15;
  word-break:break-word;
}

/* subtle focus */
.student-toggle:focus, .class-toggle:focus{ outline:2px solid rgba(11,116,255,0.12); outline-offset:3px; border-radius:6px; }

/* hover styles */
table.leader tbody tr:hover{ background: #fbfdff; }

/* compact variant for 'your rank' row highlight */
#myRankRow{ background:#f7fbff; box-shadow:0 6px 20px rgba(37,99,235,0.04); }

/* Divider row */
.table-divider td{ text-align:center; padding:8px; color:var(--muted); font-weight:700 }

/* Make table visually compact even more on narrow screens */
@media (max-width: 940px){
  .container{ padding:10px; max-width:760px; }
  header h1{ font-size:1rem; }
  table.leader{ min-width:580px; }
  table.leader thead th{ font-size:12px; padding:8px 6px; }
  table.leader td{ padding:8px 6px; font-size:13px; }
  .btn{ padding:6px 10px; font-size:0.88rem; }
  .rank-badge{ min-width:40px; height:40px; font-size:0.95rem; }
  .col-name{ width:auto; }
}

/* Small/mobile: make everything compact, show scroller if needed */
@media (max-width: 720px){
  :root{
    --fs-base:13px;
    --pad-td:6px;
  }
  body{ font-size:13px; }
  .container{ padding:8px; max-width:640px; }
  table.leader{ min-width:520px; }
  table.leader thead th{ font-size:11px; padding:6px 6px; }
  table.leader td{ padding:6px 6px; font-size:12px; }

  /* make columns tighter */
  .col-rank { width:48px; }
  .col-class { width:44px; }
  .col-id    { width:58px; }
  .col-points{ width:58px; }
  .col-action{ width:72px; }

  /* name & class compact truncation */
  .student-toggle, .class-toggle{
    font-size:0.95rem;
    max-width:120px; /* ensure truncation */
    white-space:nowrap;
    text-overflow:ellipsis;
    overflow:hidden;
    display:inline-block;
    padding-right:4px;
  }

  /* tiny badges */
  .rank-badge{ min-width:36px; height:36px; font-size:0.9rem; }
  .points-badge{ min-width:52px; padding:6px 6px; font-size:0.88rem; }
  .actions-wrap .btn{ padding:6px 8px; font-size:0.82rem; }

  /* remove large row paddings */
  table.leader td:first-child{ padding-left:10px; }

  /* allow only expanded element to wrap and take space in row — other rows remain compact */
  .student-toggle.expanded, .class-toggle.expanded{
    position:relative;
    display:block;
    white-space:normal;
    font-size:1rem;
  }
}

/* Very small phones */
@media (max-width:420px){
  :root{ --fs-base:12px; }
  body{ font-size:12px; }
  .container{ padding:6px; max-width:420px; }
  table.leader{ min-width:480px; }
  table.leader thead th{ font-size:10px; padding:6px 6px; }
  table.leader td{ font-size:11px; padding:6px 6px; }

  .student-toggle, .class-toggle{ max-width:90px; }
  .col-rank { width:44px; }
  .col-action{ width:64px; }
  .id-mask{ font-size:0.9rem; }
  .rank-badge{ min-width:34px; height:34px; font-size:0.88rem; }
}

/* small scrollbar polish (webkit) */
.table-wrap::-webkit-scrollbar{ height:8px; width:8px; }
.table-wrap::-webkit-scrollbar-thumb{ background:rgba(11,116,255,0.16); border-radius:8px; }
.table-wrap::-webkit-scrollbar-track{ background:transparent; }

/* Safe default for text truncation inside td if long content exists */
table.leader td > *{ max-width:100%; overflow:hidden; text-overflow:ellipsis; }

/* Utility to visually reduce the header space (if you want even closer headers) */
.header-tight header, .header-tight .comp-actions { padding:0; margin:0; gap:6px; }

/* accessibility focus for keyboard users */
.btn:focus, a:focus{ outline-offset:2px; outline:2px solid rgba(11,116,255,0.12); }

/* End of stylesheet */

</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="comp-info">
        <div style="display:flex;gap:8px;align-items:center">
          <h1>Leaderboard</h1>
          <div id="studentTag" class="small-muted" style="font-weight:700"></div>
        </div>
        <div class="small-muted" id="competitionSub">Loading competition…</div>
      </div>

      <div class="comp-actions">
        <button id="backBtn" class="btn">Back</button>
        <button id="verifyBtn" class="btn">Verify</button>
        <button id="viewAroundBtn" class="btn">View around me</button>
        <button id="toggleBgBtn" class="btn">BG Sound: OFF</button>
        <button id="toggleFxBtn" class="btn">FX Sound: ON</button>
        <button id="testYourselfBtn" class="btn btn-primary">Test Yourself</button>
        <button id="logoutBtn" class="btn">Logout</button>
      </div>
    </header>

    <div id="adminControls" class="card hidden">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
        <div>
          <label style="font-weight:700">Manage competition</label>
          <div class="small-muted">
            Manage competition settings and view all scorers.
          </div>
        </div>
    
        <div style="display:flex;gap:8px;align-items:center">
          <!-- ONLY these buttons stay -->
          <button id="manageCompBtn" class="btn" style="display:none">Manage</button>
          <button id="viewAllBtn" class="btn" style="display:none">View all scorers</button>
        </div>
      </div>
    </div>
    

    <div id="leaderContainer" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <strong id="compTitle">—</strong>
          <div class="small-muted" id="compRange"></div>
        </div>
        <!-- <div class="small-muted">Top ranks (ties allowed) — showing rank, student, class, id (last 4 digits), points</div> -->
      </div>

     <!-- put this inside #leaderContainer where your table currently is -->
<div class="table-wrap">
  <table class="leader" id="leaderTable">
    <colgroup>
      <col class="col-rank">
      <col class="col-name">
      <col class="col-class">
      <col class="col-id">
      <col class="col-points">
      <col class="col-action">
    </colgroup>
    <thead>
      <tr>
        <th class="col-rank">Rank</th>
        <th class="col-name">Name</th>
        <th class="col-class">Class</th>
        <th class="col-id">ID</th>
        <th class="col-points">Points</th>
        <th class="col-action">Action</th>
      </tr>
    </thead>
    <tbody id="leaderTbody">
      <tr><td colspan="6" class="small-muted">Loading…</td></tr>
    </tbody>
  </table>
</div>

    </div>

    <div id="moreArea"></div>
  </div>

  <!-- modal container -->
  <div id="modalRoot" class="hidden"></div>

  <!-- scripts -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="leaderboard.js"></script>
</body>
</html>
